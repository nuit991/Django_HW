<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gym People Count</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        let updateCount = 0;
        let countdownValue = 10; // 倒计时的初始值，单位为秒

        function updateGymData() {
            $.get('/api/gym-data/', function(data) {
                const gymData = data.gym_data;
                const gymList = $('#gym-list');
                gymList.empty();  // 清空当前列表
                gymData.forEach(function(gym) {
                    gymList.append(`
                        <li>
                            <strong>${gym.name}</strong><br>
                            Pool: ${gym.pool_people}<br>
                            Gym: ${gym.gym_people}
                        </li>
                    `);
                });
                updateCount += 1;  // 增加更新次数
                $('#update-count').text(updateCount);  // 更新页面上的显示次数
                countdownValue = 10; // 重置倒计时值
            });
        }

        function startCountdown() {
            setInterval(function() {
                if (countdownValue > 0) {
                    countdownValue -= 1;
                } else {
                    updateGymData();
                    countdownValue = 10; // 重置倒计时值
                }
                $('#countdown').text(countdownValue); // 更新倒计时显示
            }, 1000); // 每秒更新一次倒计时
        }

        $(document).ready(function() {
            // 初次加载时更新数据
            updateGymData();
            // 开始倒计时
            startCountdown();
        });
    </script>
</head>
<body>
    <h1>Gym People Count</h1>
    <p>更新次數: <span id="update-count">0</span></p>  <!-- 增加显示更新次数的元素 -->
    <p>更新倒數計時: <span id="countdown">10</span> 秒</p> <!-- 增加显示倒计时的元素 -->
    <ul id="gym-list">
        {% for gym in gym_data %}
            <li>
                <strong>{{ gym.name }}</strong><br>
                Pool: {{ gym.pool_people }}<br>
                Gym: {{ gym.gym_people }}
            </li>
        {% endfor %}
    </ul>
</body>
</html>











<!--
<!DOCTYPE html>: 声明文档类型为 HTML5。
<html lang="en">: 定义文档的语言为英语。
<meta charset="UTF-8">: 设置文档的字符编码为 UTF-8。
<title>Gym People Count</title>: 定义网页的标题为“Gym People Count”。

---
引入 jQuery
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>: 引入 jQuery 库，版本为 3.6.0。

---
JavaScript 部分解释
let updateCount = 0;: 初始化一个全局变量 updateCount，用于记录更新次数。
updateGymData 函数
1.$.get('/api/gym-data/', function(data) {...}): 发送 GET 请求到 /api/gym-data/，并在成功获取数据后执行回调函数。

2.const gymData = data.gym_data;: 从返回的数据中获取 gym_data。
->透過 const 我們可以宣告常數。
->data 是通过 AJAX 请求从服务器获取的 JSON 响应。这个响应是由 Django 视图 gym_data_api (myapp/views.py)返回的，它包含了一个名为 gym_data 的键。

3.const gymList = $('#gym-list');: 获取 ID 为 gym-list 的元素。
->'#gym-list':可以自己定义，只要你在 HTML 中使用了这个 ID。

4.gymList.empty();: 的作用是删除 gymList 元素内部的所有子元素和文本内容。换句话说，它会清空 gymList 元素内的所有内容，使其变成一个空元素。
->动态更新内容：当你需要更新某个容器内的内容时，可以先清空容器，然后再插入新的内容。

5.gymData.forEach(function(gym) {...}): 遍历 gymData 数组，将每个 gym 的数据插入列表中。
->gymData: 上面定義的
-->
JavaScript .forEach(跟pythton的for 迴圈類似)
语法：array.forEach(callback(currentValue, index, array))
回调函数：
currentValue：当前遍历的元素。
index：当前元素的索引（可选）。
array：原数组（可选）。
特点：forEach 方法只能用于数组，不能中途停止（不能用 break 或 return 跳出循环）。
---
gymList.append(`
                        <li>
                            <strong>${gym.name}</strong><br>
                            Pool: ${gym.pool_people}<br>
                            Gym: ${gym.gym_people}
                        </li>
                    `);
gymList.append:在 jQuery 中，append() 方法用于向选定元素的末尾添加内容。網頁按F12出現的那一堆東西
---

6.updateCount += 1;: 更新次数加 1。
7.$('#update-count').text(updateCount);: 更新页面上显示的更新次数。
->使用 jQuery 选择器 $('#update-count') 选中 id 为 update-count 的元素。
->.text(updateCount) 将选中元素的文本内容设置为 updateCount 的当前值。

8.$(document).ready(function() {...}): 当文档加载完成时执行的函数。
---
$(document).ready(function() {
            // 初次加载时更新数据
            updateGymData();
            // 每分钟更新一次
            setInterval(updateGymData, 10000);
---
->$(document): 这是 jQuery 中的一个函数，它用来选取文档对象（即整个 HTML 文档）。
->.ready(function() { ... }): 这是 $(document) 对象的一个方法，用于在文档加载完成后执行指定的函数。它的作用是等待页面的所有元素加载完成后再执行函数内的代码。
->function() { ... }: 这是一个匿名函数（或者叫回调函数），定义了在文档加载完成后要执行的具体代码块。
->updateGymData();: 呼叫這個函數，是要重复执行的
->setInterval 是 JavaScript 提供的一个函数，用于按照指定的时间间隔重复执行指定的函数或代码块。
->10000 是指定的时间间隔，单位是毫秒。在这里，设定为 10000 毫秒，即每隔 10 秒执行一次 updateGymData 函数。

*->作用是确保在文档加载完成后再执行包裹的函数内的代码，大概就是整個網頁加載完畢，就會開始這段程式碼

9.updateGymData();: 初次加载时调用 updateGymData 函数。
10.setInterval(updateGymData, 10000);: 每 10 秒钟调用一次 updateGymData 函数，定期更新数据。

---
HTML 模板部分解释
身体部分（body）
<h1>Gym People Count</h1>: 标题。
<p>更新次數: <span id="update-count">0</span></p>: 显示更新次数，初始值为 0。
<ul id="gym-list">...</ul>: 显示 gym 数据的列表。
Django 模板语法
{% for gym in gym_data %} ... {% endfor %}: Django 模板语法，遍历 gym_data 列表，并生成每个 gym 的列表项。
{{ gym.name }}, {{ gym.pool_people }}, {{ gym.gym_people }}: Django 模板变量，显示 gym 的名称、游泳池和健身房的人数。

-->
